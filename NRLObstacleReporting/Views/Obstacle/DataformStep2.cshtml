@model NRLObstacleReporting.Models.ObstacleStep2Model

<!-- Wrapper -->
<div class="flex flex-col min-h-[100dvh] justify-start px-2 pt-6">

    <!-- Progressbar -->
    <div class="relative w-full flex justify-center pb-4">
        <div class="relative w-[90%] max-w-3xl mx-auto flex flex-col items-center">

            <!-- Grå base-linje -->
            <div
                class="absolute top-[35%] left-[15%] h-[3px] rounded-full z-0 bg-gray-300"
                style="width: 70%;">
            </div>

            <!-- Blå gradientlinje fra step 1 til step 2 -->
            <div
                class="absolute top-[35%] left-[15%] h-[3px] rounded-full z-10"
                style="
        width: calc(35% + 6px);
        background: linear-gradient(to right,
          #2563eb 0%,
          #3b82f6 60%,
          #60a5fa 80%,
          #93c5fd 100%);
      ">
            </div>

            <!-- Stegene -->
            <div class="relative flex justify-between items-center w-full z-20">

                <!-- Step 1 -->
                <div class="flex flex-col items-center w-1/3 text-center">
                    <div
                        class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-blue-600 text-white 
                 flex items-center justify-center shadow text-base">
                        1
                    </div>
                    <span class="text-xs sm:text-sm md:text-base mt-2 text-blue-600 font-medium">
                      Select Obstacle Type
                    </span>
                </div>

                <!-- Step 2 (aktiv, med blå ring) -->
                <div class="flex flex-col items-center w-1/3 text-center">
                    <div class="relative flex items-center justify-center">
                        <div
                            class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-blue-600 text-white 
                   flex items-center justify-center shadow-md text-base 
                   ring-2 ring-offset-2 ring-blue-400 transition-all duration-300">
                            2
                        </div>
                    </div>
                    <span class="text-xs sm:text-sm md:text-base mt-2 text-blue-600 font-semibold">
                      Place Obstacle
                    </span>
                </div>

                <!-- Step 3 -->
                <div class="flex flex-col items-center w-1/3 text-center">
                    <div
                        class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-gray-300 text-gray-700 
                 flex items-center justify-center shadow text-base">
                        3
                    </div>
                    <span class="text-xs sm:text-sm md:text-base mt-2 text-gray-600 font-medium">
                       Describe Obstacle
                    </span>
                </div>

            </div>
        </div>
    </div>


    <!-- Innhold -->
    <section class="flex flex-col justify-start flex-grow pb-6">
        <!-- Kart -->
        <div id="map"
             style="height: 54dvh; width: 100%;"
             class="rounded-lg shadow-md"></div>

        <!-- Koordinater -->
        <div class="mt-1.5">
            <label for="CoordinatesPreview" class="block text-sm font-medium text-gray-800 mb-1">Coordinates Preview</label>
            <textarea id="CoordinatesPreview"
                      class="rounded-lg bg-blue-200 text-black text-center border-2 border-blue-900 w-full text-sm"
                      style="height: 5dvh;"
                      readonly></textarea>
        </div>

        <!-- Knappene -->
        <form asp-action="DataformStep2" method="post" class="mt-2 mb-1.5">
            @Html.AntiForgeryToken()
            <input type="hidden" asp-for="GeometryGeoJson" id="GeometryGeoJson" />
            <input asp-for="ObstacleId" type="hidden" value="@TempData.Peek("id")" />
            <input type="hidden" asp-for="SaveDraft" id="save" />

            <div class="flex justify-between w-full">
                <!-- Save Draft -->
                <button type="submit"
                        class="w-[48.5%] h-20 rounded-2xl bg-gradient-to-r from-blue-100 to-blue-200 
                       text-blue-700 text-xl font-semibold tracking-wide border border-blue-300
                       hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] 
                       transition-all duration-200 flex items-center justify-center gap-3"
                        formaction="/Obstacle/DataformStep2" id="savebutton">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                         stroke-width="2" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                              d="M5 3a2 2 0 00-2 2v16l9-4 9 4V5a2 2 0 00-2-2H5z" />
                    </svg>
                    Save Draft
                </button>

                <!-- Next Page -->
                <button type="submit"
                        class="w-[48.5%] h-20 rounded-2xl bg-gradient-to-r from-blue-600 to-blue-500 
                       text-white text-xl font-semibold tracking-wide shadow-md 
                       hover:shadow-lg hover:brightness-110 active:scale-[0.98] 
                       border border-blue-700 transition-all duration-200 flex items-center justify-center gap-3"
                        formaction="/Obstacle/DataformStep2" id="nextpage">
                    Next Page
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                         stroke-width="2" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                    </svg>
                </button>
            </div>
        </form>
    </section>
</div>

@section Scripts {
    <script src="~/js/MapScripts/GenerateMap.js" asp-append-version="true"></script>
    <script src="~/js/MapScripts/GenerateMapItems_DataformStep2.js" asp-append-version="true"></script>
    <script src="~/js/MapScripts/Geolocation.js" asp-append-version="true"></script>
    <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css" />
    <script>
        AssignValueByID('savebutton', 'save', true);
        AssignValueByID('nextpage', 'save', false);

        const zoom = 17;
        const map = GenerateMapGeolocate(zoom);
        GeolocateUser(zoom);

        const choice = @TempData.Peek("ObstacleType");
        GenerateMapItems_DataformStep2(map, choice);
    </script>
    <partial name="_ValidationScriptsPartial" />
}
