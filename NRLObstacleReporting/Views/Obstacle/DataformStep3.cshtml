@model NRLObstacleReporting.Models.ObstacleStep3Model

<!-- Progressbar -->
<div class="relative w-full flex justify-center py-3">
    <div class="relative w-[90%] max-w-3xl mx-auto flex flex-col items-center">
        <div class="absolute top-[35%] left-[15%] h-[3px] rounded-full z-0 bg-gray-300" style="width: 70%;"></div>
        <div class="absolute top-[35%] left-[15%] h-[3px] rounded-full z-10"
             style="width: calc(70% + 6px); background: linear-gradient(to right, #2563eb 0%, #3b82f6 30%, #60a5fa 60%, #93c5fd 100%);"></div>

        <div class="relative flex justify-between items-center w-full z-20">
            <div class="flex flex-col items-center w-1/3 text-center">
                <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-blue-600 text-white flex items-center justify-center shadow text-base">1</div>
                <span class="text-sm md:text-base mt-2 text-blue-600 font-medium">Select Obstacle Type</span>
            </div>
            <div class="flex flex-col items-center w-1/3 text-center">
                <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-blue-600 text-white flex items-center justify-center shadow text-base">2</div>
                <span class="text-sm md:text-base mt-2 text-blue-600 font-medium">Place Obstacle</span>
            </div>
            <div class="flex flex-col items-center w-1/3 text-center">
                <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-blue-600 text-white flex items-center justify-center shadow-md text-base ring-2 ring-offset-2 ring-blue-400 transition-all duration-300">3</div>
                <span class="text-sm md:text-base mt-2 text-blue-600 font-semibold">Describe Obstacle</span>
            </div>
        </div>
    </div>
</div>

<div class="flex flex-col justify-start items-center h-auto text-center pb-4 mt-0">
    <form asp-action="DataformStep3" method="post" class="flex flex-col items-center w-full">
        @Html.AntiForgeryToken()

        <div class="bg-white shadow-2xl rounded-2xl w-[95%] max-w-6xl py-10 px-12 border border-blue-100 mt-3 min-h-[70vh]">
        <input asp-for="ObstacleId" type="hidden" value="@TempData.Peek("id")"/>

        <!-- Main container -->
        <div class="flex flex-col w-full items-center space-y-8">

            <!-- Obstacle Name -->
            <div class="w-full max-w-3xl">
                <label class="text-lg font-semibold block text-left mb-2 text-gray-900 tracking-tight">Obstacle Name</label>
                <input asp-for="Name"
                       class="rounded-xl bg-blue-50 text-black border border-blue-200 text-lg w-full h-12 px-4 focus:ring-2 focus:ring-blue-400 outline-none hover:bg-blue-100 transition duration-200"/>
            </div>

            <!-- Obstacle Description -->
            <div class="w-full max-w-3xl">
                <label class="text-lg font-semibold block text-left mb-2 text-gray-900 tracking-tight">Obstacle Description</label>
                <textarea asp-for="Description"
                              class="rounded-xl bg-blue-50 text-black border border-blue-200 text-base w-full p-4 ..."
                              style="height: 16dvh;"></textarea>
            </div>

            <!-- Illumination -->
            <div class="w-full max-w-3xl">
                <label class="text-lg font-semibold block text-left mb-2 text-gray-900 tracking-tight">Illumination</label>
                <div class="flex w-full border border-blue-200 rounded-xl overflow-hidden bg-blue-50">
                    <button type="button" id="illuminated-yes"
                            class="illumination flex-1 py-2.5 font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 transition-all duration-200">
                        Illuminated
                    </button>
                    <button type="button" id="illuminated-unknown"
                            class="illumination flex-1 py-2.5 font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 border-l border-blue-200 transition-all duration-200">
                        Unknown
                    </button>
                    <button type="button" id="illuminated-no"
                            class="illumination flex-1 py-2.5 font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 border-l border-blue-200 transition-all duration-200">
                        Not Illuminated
                    </button>
                </div>
            </div>

            <!-- Marking -->
            <div class="w-full max-w-3xl">
                <label class="text-lg font-semibold block text-left mb-2 text-gray-900 tracking-tight">Marking</label>
                <div class="flex w-full border border-blue-200 rounded-xl overflow-hidden bg-blue-50">
                    <button type="button" id="marked-yes"
                            class="marking flex-1 py-2.5 font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 transition-all duration-200">
                        Marked
                    </button>
                    <button type="button" id="marked-unknown"
                            class="marking flex-1 py-2.5 font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 border-l border-blue-200 transition-all duration-200">
                        Unknown
                    </button>
                    <button type="button" id="marked-no"
                            class="marking flex-1 py-2.5 font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 border-l border-blue-200 transition-all duration-200">
                        Not Marked
                    </button>
                </div>
            </div>

            <!-- Buttons -->
            <div class="flex justify-between w-full max-w-3xl mt-8 gap-6">
                <!-- Save Draft -->
                <button type="submit"
                        class="w-[48.5%] h-20 rounded-2xl bg-gradient-to-r from-blue-100 to-blue-200 
                   text-blue-700 text-xl font-semibold tracking-wide border border-blue-300
                   hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] 
                   transition-all duration-200 flex items-center justify-center gap-3"
                        formaction="/Obstacle/DataformStep3" id="SaveDraft">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                         stroke-width="2" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                              d="M5 3a2 2 0 00-2 2v16l9-4 9 4V5a2 2 0 00-2-2H5z" />
                    </svg>
                    Save Draft
                </button>

                <!-- Submit Report -->
                <button type="submit"
                        class="w-[48.5%] h-20 rounded-2xl bg-gradient-to-r from-blue-600 to-blue-500 
                   text-white text-xl font-semibold tracking-wide shadow-md 
                   hover:shadow-lg hover:brightness-110 active:scale-[0.98] 
                   border border-blue-700 transition-all duration-200 flex items-center justify-center gap-3"
                        formaction="/Obstacle/DataformStep3" id="Submit">
                    Submit Report
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                         stroke-width="2" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                    </svg>
                </button>
            </div>

            <input type="hidden" asp-for="Status" id="IsDraft"/>
            <input type="hidden" asp-for="Illuminated" id="ObstacleIlluminated" value="@((int)ObstacleCompleteModel.Illumination.Unknown)"/>
            <input type="hidden" asp-for="Marking" id="ObstacleMarked" value="@((int)ObstacleCompleteModel.ObstacleMarking.Unknown)"/>
          </div>
        </div>
    </form>
</div>



@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        AssignValueByID('illuminated-yes', 'ObstacleIlluminated', @((int)ObstacleCompleteModel.Illumination.Illuminated));
        AssignValueByID('illuminated-no', 'ObstacleIlluminated', @((int)ObstacleCompleteModel.Illumination.NotIlluminated));
        AssignValueByID('illuminated-unknown', 'ObstacleIlluminated', @((int)ObstacleCompleteModel.Illumination.Unknown));

        AssignValueByID('marked-yes', 'ObstacleMarked', @((int)ObstacleCompleteModel.ObstacleMarking.Marked));
        AssignValueByID('marked-no', 'ObstacleMarked', @((int)ObstacleCompleteModel.ObstacleMarking.NotMarked));
        AssignValueByID('marked-unknown', 'ObstacleMarked', @((int)ObstacleCompleteModel.ObstacleMarking.Unknown));

        AssignValueByID('SaveDraft', 'IsDraft', 0);
        AssignValueByID('Submit', 'IsDraft', 1);
        
       function setupToggle(groupSelector) {
            const inactive = 'bg-blue-100 text-blue-700 hover:bg-blue-200 shadow-none';
            const active = 'bg-blue-500 text-white hover:bg-blue-500 shadow-md transition-all duration-150 ease-in-out';
            const buttons = document.querySelectorAll(groupSelector);

            buttons.forEach(b => {
                b.addEventListener('click', () => {
                    buttons.forEach(other => {
                        other.classList.remove(...active.split(' '));
                        inactive.split(' ').forEach(c => other.classList.add(c));
                    });
                    
                    b.classList.remove(...inactive.split(' '));
                    active.split(' ').forEach(c => b.classList.add(c));
                    
                    b.classList.add('scale-[0.98]');
                    setTimeout(() => b.classList.remove('scale-[0.98]'), 100);
                });
            });
        }

        setupToggle('.illumination');
        setupToggle('.marking');
    </script>
}