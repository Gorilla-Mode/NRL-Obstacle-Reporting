@model NRLObstacleReporting.Models.ObstacleCompleteModel
@{
    ViewData["Title"] = "Report Overview";
}

<div class="text-center">
    <h1 class="display-4">Overview</h1>
</div>

<div class="flex justify-center mt-6 mx-auto">
    <table class="table-auto border border-gray-300 text-center">
        <caption class="caption-top text-lg font-bold mb-2">
            Obstacle Report: @Model.ObstacleId
        </caption>
        <thead>
            <tr>
                <th class="border border-gray-300 px-4 py-2 bg-blue-300 text-black rounded-tl-md">Data</th>
                <th class="border border-gray-300 px-4 py-2 bg-blue-300 text-black rounded-tr-md">Response</th>
            </tr>
        </thead>
        <tbody>
        <!-- ObstacleName -->
        <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 px-4 py-2 text-black rounded-tr-md font-bold">Name</td>
            <td class="border border-gray-300 px-4 py-2">@Model.Name</td>
        </tr>
        <!-- ObstacleHeight -->
        <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 px-4 py-2 text-black rounded-tr-md font-bold">Height</td>
            <td class="border border-gray-300 px-4 py-2">@Model.HeightMeter</td>
        </tr>
        <!-- ObstacleDescription -->
        <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 px-4 py-2 text-black rounded-tr-md font-bold">Description</td>
            <td class="border border-gray-300 px-4 py-2">@Model.Description</td>
        </tr>
        <!-- ObstacleType -->
        <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 px-4 py-2 text-black rounded-tr-md font-bold">Type</td>
            <td class="border border-gray-300 px-4 py-2">@Model.Type</td>
        </tr>
        <!-- Illuminated-->
        <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 px-4 py-2 text-black rounded-tr-md font-bold">Illuminated</td>
            <td class="border border-gray-300 px-4 py-2">@Model.Illuminated</td>
        </tr>
        <!-- Status-->
        <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 px-4 py-2 text-black rounded-tr-md font-bold">Status</td>
            <td class="border border-gray-300 px-4 py-2">@Model.Status</td>
        </tr>
        <!-- Status-->
        <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 px-4 py-2 text-black rounded-tr-md font-bold">Marking</td>
            <td class="border border-gray-300 px-4 py-2">@Model.Marking</td>
        </tr>
        <!-- ObstacleCoordinates -->
        <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 px-4 py-2 text-black rounded-tr-md font-bold">Coordinates</td>
            <td class="border border-gray-300 px-4 py-2">@Model.GeometryGeoJson</td>
        </tr>
        
        </tbody>
    </table>
</div>

@if (Model?.GeometryGeoJson != null)
{
    <div class="h-dvh overflow-hidden rounded-xl mx-auto my-2">

        <section>
            <div class="mx-auto "
                id="map" style="height: 50dvh; width: 100%; border-radius: 0.75rem; overflow: hidden; border: 1px solid #e5e7eb; z-index: 0">
            </div>
        </section>
    </div>
}

@section Scripts {
    @* Script to add a map to the view *@
    @if (Model?.GeometryGeoJson != null)
    { 
        <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css"/>
        <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
        <script src="~/js/MapScripts/GeoJsonExtractCoordinates.js" asp-append-version="true"></script>
        <script src="~/js/MapScripts/GenerateMap.js" asp-append-version="true"></script>
        <script>
        let map = GenerateMap(17);
    
        let geojsonCoordinates = @Html.Raw(Model.GeometryGeoJson)
        // var geojsonData = JSON.parse(geojsonCoordinates);
        let geojsonLayer = L.geoJSON(geojsonCoordinates);
        geojsonLayer.addTo(map);
        
        map.setView(GeoJsonExtractCoordinates(geojsonCoordinates));
         </script>
    }
}